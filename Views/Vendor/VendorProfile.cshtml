@model PUP_Online_Lagoon_System.Models.DTO.VendorProfileDTO
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Profile - PUP Lagoon</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="~/css/vendor/vendor-profile.css" asp-append-version="true">
</head>
<body>

    <header class="profile-header">
        <div class="header-top">
            <a asp-controller="Vendor" asp-action="VendorDashboard" class="back-button">
                <i class="fas fa-arrow-left"></i>
            </a>
            <h1 class="header-title">Vendor Settings</h1>
        </div>

        <div class="profile-summary">
            <div class="avatar-circle">
                <i class="fas fa-store"></i>
            </div>
            <div class="user-text">
                <h2 class="user-name">@Model.vendorDetails.FirstName @Model.vendorDetails.LastName</h2>
                <p class="user-role">Vendor Account</p>
            </div>
        </div>
    </header>

    <div class="main-content">

        <h3 class="section-label">Personal Information</h3>
        <form asp-controller="Vendor" asp-action="SaveProfile" method="post">
            <input name="vendorId" type="text" hidden value="@Model.vendorDetails.Vendor_ID">
            <div class="form-card">
                <div class="input-group">
                    <label>First Name</label>
                    <input name="firstName" type="text" value="@Model.vendorDetails.FirstName" class="input-field">
                </div>
                <div class="input-group">
                    <label>Last Name</label>
                    <input name="lastName" type="text" value="@Model.vendorDetails.LastName" class="input-field">
                </div>
                <div class="input-group">
                    <label>Contact Number</label>
                    <input name="contactNum" type="text" value="@Model.vendorDetails.ContactNum" class="input-field">
                </div>
                <div class="input-group email-input-group">
                    <label>Email (Fixed by Admin)</label>
                    <div class="readonly-field">
                        <i class="far fa-envelope"></i>
                        <span>@Model.userDetails.Email</span>
                    </div>
                </div>

                <button class="btn-save">Save Profile</button>
            </div>
        </form>

        <h3 class="section-label">Stall Details</h3>
        <form asp-controller="Vendor" asp-action="SaveStallSettings" method="post">
            <input name="stallId" type="text" hidden value="@Model.stallDetails.Stall_ID">
            <div class="form-card">
                <div class="input-group">
                    <label>Stall Name</label>
                    <input name="stallName" type="text" value="@Model.stallDetails.StallName" class="input-field">
                </div>
                <div class="input-group">
                    <label>Stall Description</label>
                    <textarea name="stallDescription" value="@Model.stallDetails.StallDescription" class="input-field textarea-field">@Model.stallDetails.StallDescription
                    </textarea>
                </div>

                <button class="btn-save">Save Stall Settings</button>
            </div>
        </form>

        <h3 class="section-label">Stall Status</h3>
        <div class="form-card">
            <div class="input-group stall-status-group">
                <div class="status-toggle-row">
                    <form asp-controller="QuickVendor" asp-action="ToggleStallStatus" asp-route-stallId="@Model.stallDetails.Stall_ID" method="post">
                        @if (Model.stallDetails.Status == true)
                        {
                            <label class="switch">
                                <input type="checkbox" checked onchange="this.form.submit()">
                                <span class="slider round"></span>
                            </label>
                            <div class="status-labels">
                                <span class="status-main text-green">Open</span>
                                <span class="status-sub">Accepting orders</span>
                            </div>
                        }
                        else
                        {
                            <label class="switch">
                                <input type="checkbox" onchange="this.form.submit()">
                                <span class="slider round"></span>
                            </label>
                            <div class="status-labels">
                                <span class="status-main text-red">Closed</span>
                                <span class="status-sub">Not Accepting orders</span>
                            </div>
                        }
                    </form>
                </div>
            </div>
        </div>

        <h3 class="section-label">Change Password</h3>
        <div class="form-card">
            @if (Model.passwordChangeStatus == "incorrect")
            {
                <div class="alert alert-danger" role="alert" style="font-size: 0.8em; padding: 0.5em 1em;">
                      !!! Incorrect password
                </div>
            }
            else if (Model.passwordChangeStatus == "repeated")
            {
                <div class="alert alert-danger" role="alert" style="font-size: 0.8em; padding: 0.5em 1em;">
                    !!! Your new password can't be the same as your old password
                </div>
            }
            else if (Model.passwordChangeStatus == "success")
            {
                <div class="alert alert-success" role="alert" style="font-size: 0.8em; padding: 0.5em 1em;">
                    Password changed successfully
                </div>
            }

            <form id="vendor-form" asp-controller="Vendor" asp-action="SaveUpdatePassword" method="post">
                <input name="vendorId" type="text" hidden value="@Model.vendorDetails.Vendor_ID">

                <label class="sub-label">Current Password</label>
                <input name="currPassword" type="password" required id="input-current-password" placeholder="Enter current password" class="input-field mb-4">

                <label class="sub-label">New Password</label>
                <input name="newPassword" type="password" required id="input-new-password" placeholder="At least 6 characters" class="input-field mb-4">

                <label class="sub-label">Confirm New Password</label>
                <input type="password" required id="input-confirm-password" placeholder="Re-enter new password" class="input-field mb-4">

                <button type="button" onclick="checkPasswordConfirm()" class="btn-save btn-save-password btn-disable">
                    <i class="fas fa-lock"></i> Update Password
                </button>
            </form>
        </div>

        <h3 class="section-label">Performance</h3>
        <div class="info-card center-text">
            <h2 class="big-number">@Model.totalOrderCount</h2>
            <p class="number-label">Total Orders</p>
        </div>

        <div class="logout-card">
            <a asp-controller="Account" asp-action="Logout" class="logout-link">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </div>

    </div>

    <nav class="bottom-nav">
        <a href="VendorDashboard" class="nav-item">
            <i class="fas fa-store"></i>
            <span>Home</span>
        </a>

        <a href="VendorOrderHistory" class="nav-item">
            <i class="fas fa-receipt"></i>
            <span>Orders</span>
        </a>

        <a href="VendorMenu" class="nav-item">
            <i class="fas fa-bars"></i>
            <span>Menu</span>
        </a>

        <a href="VendorProfile" class="nav-item active">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </a>
    </nav>

</body>

<script>
    function checkPasswordConfirm() {
        const currPasswordInputElem = document.getElementById("input-current-password");
        const newPasswordInputElem = document.getElementById("input-new-password");
        const confPasswordInputElem = document.getElementById("input-confirm-password");
        const form = document.getElementById("vendor-form");

        currPassLength = currPasswordInputElem.value.length;
        newPassLength = newPasswordInputElem.value.length;
        confPassLength = confPasswordInputElem.value.length;

        if(newPasswordInputElem.value == confPasswordInputElem.value && newPassLength >= 6 && confPassLength >= 6 && currPassLength > 3) {
            form.submit();
        }
    }
</script>